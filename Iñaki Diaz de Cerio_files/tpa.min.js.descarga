define("tpa",["lodash","coreUtils","componentsCore","experiment","zepto","utils","reactDOM","warmupUtils","core","layout","tpaComponents","pmrpc"],function(e,t,i,n,a,o,r,s,p,c,u,g){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1799)}({0:function(t,i){t.exports=e},1:function(e,i){e.exports=t},10:function(e,t){e.exports=o},11:function(e,t){e.exports=r},13:function(e,t){e.exports=s},1799:function(e,t,i){var n,a;n=[i(0),i(1800),i(537),i(319),i(540),i(541),i(542),i(10),i(538),i(543),i(546),i(1805),i(42)],void 0===(a=function(e,t,i,n,a,o,r,s,p,c,u,g,d){"use strict";return e.assign({},d,{gluedWidgetMeasuringUtils:p,GluedWidgetPatcher:i,tpaMeasurer:n,tpaSectionPatcher:a,tpaHandlers:r,common:e.assign({},d.common,{tpaPostMessageCommon:o,styleUtils:s.styleUtils,bi:u}),services:e.assign({},d.services,{tpaNavigationService:c}),tpaStyleUtils:s.styleUtils})}.apply(t,n))||(e.exports=a)},1800:function(e,t,i){var n,a;n=[i(33),i(537),i(1801),i(540),i(319),i(539),i(1802),i(1)],void 0===(a=function(e,t,i,n,a,o,r,s){"use strict";var p=new t(o),c=new i;return e.registerCustomMeasure("wysiwyg.viewer.components.tpapps.TPAWidget",a.measureTPA),e.registerCustomMeasure("wysiwyg.viewer.components.tpapps.TPASection",a.measureTPA),e.registerCustomMeasure("wysiwyg.viewer.components.tpapps.TPAMultiSection",a.measureTPA),e.registerCustomMeasure("wysiwyg.viewer.components.tpapps.TPAGluedWidget",c.measureGluedWidget),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAWidget"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAGluedWidget"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPASection"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAMultiSection"),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.tpapps.TPASection",[["iframe"]]),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.tpapps.TPAMultiSection",[["iframe"]]),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.tpapps.TPAWidget",[["iframe"]]),e.registerPatcher("wysiwyg.viewer.components.tpapps.TPAGluedWidget",p.patchGluedWidget),e.registerPatcher("wysiwyg.viewer.components.tpapps.TPAMultiSection",n.patchTPASection),e.registerPatcher("wysiwyg.viewer.components.tpapps.TPASection",n.patchTPASection),e.registerPatcher("wysiwyg.viewer.components.tpapps.TPAWidget",function(e,t,i,n,a){r.patchWidth(e,t,i,n,a),s.layoutUtils.getLayoutMechanism(a)===s.constants.LAYOUT_MECHANISMS.MESH&&t.css(e,{height:i.height[e]+"px"})}),["wysiwyg.viewer.components.WixAdsMobile","wysiwyg.viewer.components.WixAdsDesktop"].forEach(function(t){e.registerRequestToMeasureChildren(t,[["desktopWADTop"],["desktopWADBottom"],["mobileWADTop"]])}),{}}.apply(t,n))||(e.exports=a)},1801:function(e,t,i){var n,a;n=[i(0),i(9),i(319),i(538)],void 0===(a=function(e,t,i,n){"use strict";return function(){this.measureGluedWidget=function(a,o,r,s,p){var c=p.getClientSpecMap,u=p.isMobileView,g=s.propertiesItem,d=s.dataItem,l=e.assign(s.layout,{height:t(r[a]).height(),width:t(r[a]).width()}),f=o.width.screen,m=o.height.screen,v={props:g,data:d,layout:l},I=n.getGluedWidgetMeasurements(c(),v,f,m,o.siteMarginBottom,u());(I=function(e){return 0===e.right&&(e.left="auto"),0===e.bottom&&(e.top="auto"),0===e.left&&(e.right="auto"),0===e.top&&(e.bottom="auto"),e}(I)).fixedTop=I.top,I.fixedLeft=I.left,delete I.top,delete I.left,e.forEach(I,function(e,t){o[t]=o[t]||{},o[t][a]=e}),e.set(o.custom,[a,"has-ads"],Boolean(t(r[a]).data("has-ads"))),o.width[a]=l.width,i.measureTPA(a,o,r)}.bind(this)}}.apply(t,n))||(e.exports=a)},1802:function(e,t,i){var n;void 0===(n=function(){"use strict";return{patchWidth:function(e,t,i,n,a){a.os.ios&&a.browser.safari&&i.custom[e].hasIframe&&t.css(e+"iframe",{width:1,minWidth:"100%"})}}}.apply(t,[]))||(e.exports=n)},1803:function(e,t,i){var n,a;n=[i(13)],void 0===(a=function(e){"use strict";var t=e.tpaWarmup,i=function(e,i,n){if(e&&e.reportPerformanceBiEvent){var a=e.getAppData(),o=e.getWidgetId(a);t.reportPerformanceBiEvent(i,e.props.reportBI,e.props.biData,e.props.id,e.props.isTpaRenderedInSsr,a,o,n)}};return{applicationLoaded:function(e,n){var a=e.getComponentById(n.compId);i(a,t.events.APP_LOADED_SUCCESSFULLY)},applicationLoadingStep:function(e,n){var a=e.getComponentById(n.compId),o={stage:n.data.stage,stageNum:n.data.stageNum};i(a,t.events.APP_LOADED_PARTIALLY,o)}}}.apply(t,n))||(e.exports=a)},1804:function(e,t,i){var n,a;n=[i(42),i(1)],void 0===(a=function(e,t){"use strict";var i=function(){};return{toWixDate:i,getCompId:i,getOrigCompId:i,getWidth:i,getLocale:i,getCacheKiller:i,getTarget:i,getInstanceId:i,getSignDate:i,getUid:i,getPermissions:i,getIpAndPort:i,getDemoMode:i,getDeviceType:i,getInstanceValue:i,getSiteOwnerId:i,getImageUrl:i,getResizedImageUrl:i,getAudioUrl:i,getDocumentUrl:i,getSwfUrl:i,getPreviewSecureMusicUrl:i,getStyleParams:function(i,n){var a=e.common.utils.getAppDefId(i,n.compId);t.loggingUtils.performance.start("getStyleParams "+a,e.common.metaData.PERF_CATEGORY)},getStyleColorByKey:i,getColorByreference:i,getEditorFonts:i,getSiteTextPresets:i,getFontsSpriteUrl:i,getStyleFontByKey:i,getStyleFontByReference:i,getSiteColors:i,setUILIBParamValue:i,tpaWorker:{getViewMode:i,getDeviceType:i,getLocale:i,getInstanceId:i,getIpAndPort:i}}}.apply(t,n))||(e.exports=a)},1805:function(e,t,i){var n,a;n=[i(3),i(1806),i(1807),i(1809),i(1810),i(1812),i(1813),i(1814),i(1815),i(1816),i(1817),i(1818),i(1819)],void 0===(a=function(e,t,i,n,a,o,r,s,p,c,u,g,d){"use strict";var l=e.siteAspectsRegistry;l.registerSiteAspect("tpaWorkerAspect",t),l.registerSiteAspect("tpaPostMessageAspect",i),l.registerSiteAspect("tpaPopupAspect",n),l.registerSiteAspect("tpaPubSubAspect",a),l.registerSiteAspect("tpaPixelTrackerAspect",o),l.registerSiteAspect("tpaModalAspect",r),l.registerSiteAspect("tpaMobileViewportAspect",s),l.registerSiteAspect("tpaCompStateAspect",p),l.registerSiteAspect("tpaComponentsDomAspect",c),l.registerSiteAspect("tpaPageNavigationAspect",u),l.registerSiteAspect("TPARPCAspect",g),l.registerSiteAspect("nativeSantaTypesAspect",d)}.apply(t,n))||(e.exports=a)},1806:function(e,t,i){var n,a;n=[i(0)],void 0===(a=function(e){"use strict";function t(e){this._aspectSiteAPI=e}return t.prototype={getComponentsToRender:function(){var t=this._aspectSiteAPI.getSiteData().getClientSpecMap(),i=this.getTPAWorkers(t);return e.map(i,function(e){var t,i="tpaWorker_"+e.applicationId;return{structure:(t=i,{componentType:"tpa.viewer.classes.TPAWorker",skin:"wysiwyg.viewer.skins.TPAWidgetSkin",type:"Component",id:t}),props:{compData:e}}})},getTPAWorkers:function(t){return e.filter(t,function(t){return e.isString(t.appWorkerUrl)&&t.permissions&&!t.permissions.revoked})}},t}.apply(t,n))||(e.exports=a)},1807:function(e,t,i){var n,a;n=[i(0),i(541),i(542),i(1808),i(545),i(42),i(546),i(67),i(1)],void 0===(a=function(e,t,i,n,a,o,r,s,p){"use strict";var c={getCtToken:!0,refreshCurrentMember:!0};var u=function(t){if(e.has(t,"data")&&!e.isNull(t.data))return t.data.eventKey&&p.stringUtils.startsWith(t.data.eventKey,o.common.utils.Constants.TPA_PUB_SUB_PREFIX)},g=function(e){return u(e)?n:(t=e.compId)&&p.stringUtils.startsWith(t,"tpaWorker_")?i.tpaWorker:i;var t},d=function(i,n,a){if(function(t,i,n){var a=i&&t.getComponentById(i);return("appStateChanged"!==n||a&&e.includes(t.getAllRenderedRootIds(),a.props.rootId))&&function(e,t,i){return!c[i]||o.services.clientSpecMapService.isSuperAppByCompId(e,t)}(t,i,n)}(i,n.compId,n.type)&&!function(e,t,i){if(!t.compId)return!1;if(e.getComponentById(t.compId))return!1;return e.getSiteAspect("tpaPostMessageAspect").queueMessage({msg:t,response:i}),!0}(i,n,a)){var s=t.fixOldPingPongMessageType(n.type),p=g(n);if(p[s]&&(p[s].call(this,i,n,a),function(t,i){if("registerEventListener"===i.type&&!u(i))return e.includes(o.common.supportedSiteEvents,i.data.eventKey);return!0}(0,n))){var d=i.getComponentById(n.compId);r.sendBIEvent(n,n.origin||"viewer",e.get(d,"props.compData"),o.common.utils.getClientSpecMap(i),i.reportBI)}}},l=function(t){return function t(i,n){return e.isFunction(i)?e.partial(i,n):e.isObject(i)?e.mapValues(i,function(e){return t(e,n)}):i}({openModal:a.openModal,openPopup:a.openPopup},t)};var f=function(t){var i=this;e.bindAll(this,e.functionsIn(this)),t.registerToMessage(this.handleTPAMessage),t.getSiteData().isInSSR()||t.getSiteData().isAddPanelView||s.api.set("tpaHandlers",l(t)),this._siteAPI=t,this._messageQueue=[],t.registerToOnFullyRendered(function(){e.forEach(i._messageQueue,function(e){var t=e.msg,n=e.response;d(i._siteAPI,t,n)}),i._messageQueue.length=0})};return f.prototype={handleTPAMessage:function(e){t.handleTPAMessage.call(this,void 0,this._siteAPI,d,e)},sendPostMessage:function(e,i){var n=e.getIframe();if(n)t.callPostMessage(n,i);else if(this._siteAPI.getSiteData().isDebugMode())throw new Error("No iframe found in TPA component",e)},queueMessage:function(e){this._messageQueue.push(e)},callHandler:d},f}.apply(t,n))||(e.exports=a)},1808:function(e,t,i){var n,a;n=[i(42),i(1)],void 0===(a=function(e,t){"use strict";var i=t.loggingUtils.logger;return{registerEventListener:function(e,t){e.getSiteAspect("tpaPubSubAspect").subscribe(t)},publish:function(t,n){var a=n.data,o=n.compId,r=e.common.utils.getAppDefId(t,o);r?(a.eventKey=e.common.utils.stripPubSubPrefix(a.eventKey),t.getSiteAspect("tpaPubSubAspect").publish(r,o,a)):i.reportBI(t.getSiteData(),e.bi.errors.SDK_PUBSUB_PUBLISH_ERROR)},removeEventListener:function(t,i){var n=i.compId,a=i.data,o=e.common.utils.getAppDefId(t,n),r=e.common.utils.stripPubSubPrefix(a.eventKey);t.getSiteAspect("tpaPubSubAspect").unsubscribe(o,n,r)}}}.apply(t,n))||(e.exports=a)},1809:function(e,t,i){var n,a;n=[i(0),i(1)],void 0===(a=function(e,t){"use strict";var i="tpaPopupAspect";function n(e){return e.getAspectGlobalData(i)}function a(t){return t&&e.isArray(t)&&t.length>0}function o(t){this.aspectSiteApi=t,e.bindAll(this,e.functionsIn(this)),this.aspectSiteApi.registerToUrlPageChange(this.removeAllPopups)}return o.prototype={getComponentsToRender:function(){var t=n(this.aspectSiteApi);return a(t)?e.map(t,function(e){return{structure:e.structure,props:{compData:e.popupData,onCloseCallback:e.popupOnClose}}}):null},showPopup:function(e,o){var r={structure:{componentType:"wysiwyg.viewer.components.tpapps.TPAPopup",type:"Component",id:t.guidUtils.getUniqueId(),skin:"wysiwyg.viewer.skins.TPAPopupSkin",styleId:""},popupData:e,popupOnClose:o},s=n(this.aspectSiteApi);a(s)||(s=[]),s.push(r),this.aspectSiteApi.setAspectGlobalData(i,s),this.aspectSiteApi.forceUpdate()},removePopup:function(t){var o=t.props.id,r=n(this.aspectSiteApi);a(r)&&(r=e.reject(r,{structure:{id:o}}),this.aspectSiteApi.setAspectGlobalData(i,r),this.aspectSiteApi.forceUpdate())},removeAllPopups:function(){var t=n(this.aspectSiteApi);a(t)&&(this.aspectSiteApi.setAspectGlobalData(i,function(t){return e.filter(t,{popupData:{persistent:!0}})}(t)),this.aspectSiteApi.forceUpdate())}},o}.apply(t,n))||(e.exports=a)},1810:function(e,t,i){var n,a;n=[i(0),i(42),i(1811)],void 0===(a=function(e,t,i){"use strict";var n=function(t){this.aspectSiteAPI=t,this.hub=new i,e.bindAll(this,e.functionsIn(this))};return n.prototype={publish:function(i,n,a){var o=this,r=a.eventKey,s=a.isPersistent,p=this.hub.getEventListeners(i,r),c=this.hub.getWorkerEventListeners(i,r),u={eventType:t.common.utils.addPubSubEventPrefix(r),intent:"addEventListener",params:{data:a.eventData,name:r,origin:n}};if(e.forEach(p,function(e){return o._sendDataToComp(e,u)}),e.forEach(c,function(e){return o._sendMessageToWorker(e,i,{eventKey:r,eventData:u.params})}),s){var g=a.eventData;this.hub.persistData(i,r,n,g)}},subscribe:function(i){var n=i.compId,a=i.data,o=t.common.utils.stripPubSubPrefix(a.eventKey),r=a.receivePastEvents,s=t.common.utils.getAppDefId(this.aspectSiteAPI,n);if(this.hub.addEventListener(s,o,n),r){var p=this.hub.getPersistedData(s,o);if(!e.isEmpty(p)){var c={intent:"TPA_RESPONSE",callId:i.callId,type:i.type,res:{drain:!0,data:p},status:!0,compId:n};this._sendDataToComp(n,c)}}},unsubscribe:function(e,t,i){this.hub.getEventListeners(e,i)&&this.hub.removeEventListener(e,i,t)},deleteCompListeners:function(e,t){this.hub.deleteCompListeners(e,t)},subscribeAsPlatformWorker:function(t,i,n,a,o){if(this.hub.addWorkerEventListener(t,n,i),a){var r=this.hub.getPersistedData(t,n);e.isEmpty(r)||this._sendMessageToWorker(i,t,{eventKey:n,callbackId:o,eventDataArray:r,invokePastEvents:!0})}},unsubscribeAsPlatformWorker:function(e,t,i){this.hub.getWorkerEventListeners(e,i)&&this.hub.removeWorkerEventListener(e,i,t)},_sendDataToComp:function(e,t){var i=this.aspectSiteAPI.getComponentById(e);i&&i.sendPostMessage(t)},_sendMessageToWorker:function(e,t,i){this.aspectSiteAPI.getSiteAPI().getSiteAspect("WidgetAspect").getWidgetHandler().invokeWorkerSubscribers(e,t,i)}},n}.apply(t,n))||(e.exports=a)},1811:function(e,t,i){var n,a;n=[i(0),i(1)],void 0===(a=function(e,t){"use strict";var i=function(e){this.hub=e||{}};return i.prototype={persistData:function(e,i,n,a){var o={data:a,name:i,origin:n},r=this._addEvent(e,i);r.data.length>=1e3&&(t.log.warn("You have exceeded the data limit, and some of the data will be lost! Please make sure you are not persisting unneeded data."),r.data.shift()),r.data.push(o)},addEventListener:function(t,i,n){var a=this._addEvent(t,i);e.includes(a.listeners,n)||a.listeners.push(n)},addWorkerEventListener:function(t,i,n){var a=this._addEvent(t,i);e.includes(a.workerListeners,n)||a.workerListeners.push(n)},removeEventListener:function(t,i,n){var a=this._getEvent(t,i);a&&(a.listeners=e.without(a.listeners,n))},removeWorkerEventListener:function(t,i,n){var a=this._getEvent(t,i);a&&(a.workerListeners=e.without(a.workerListeners,n))},getPersistedData:function(e,t){var i=this._getEvent(e,t);return i&&i.data},getEventListeners:function(e,t){var i=this._getEvent(e,t);return i&&i.listeners},getWorkerEventListeners:function(e,t){var i=this._getEvent(e,t);return i&&i.workerListeners},deleteCompListeners:function(t,i){var n=this,a=this._getAppEvents(t);e.forOwn(a,function(e,a){n.removeEventListener(t,a,i)})},_addEvent:function(e,t){var i=this.hub[e];i||(i=this.hub[e]={});var n=i[t];return n||(n=i[t]={data:[],listeners:[],workerListeners:[]}),n},_getEvent:function(e,t){var i=this.hub[e];if(i)return i[t]},_getAppEvents:function(e){return this.hub[e]}},i}.apply(t,n))||(e.exports=a)},1812:function(e,t,i){var n,a;n=[i(0),i(1),i(42)],void 0===(a=function(e,t,i){"use strict";var n=t.urlUtils,a=t.throttleUtils.throttledForEach,o=function(){var t,o=this._aspectSiteAPI.getPageUrl.bind(this._aspectSiteAPI),s=(t=this._aspectSiteAPI.getSiteData().getClientSpecMap(),e.filter(t,function(t){return e.isString(t.pixelUrl)&&t.permissions&&!t.permissions.revoked})),p=e.map(s,function(e){return new i.common.TPAUrlBuilder(e.pixelUrl).addMultipleQueryParams({instance:e.instance,page:o(),ck:n.cacheKiller()}).build()});a(p,r.sendRequest,r.CHUNK_SIZE,r.CHUNK_INTERVAL)};function r(e){this._aspectSiteAPI=e,this._aspectSiteAPI.registerToComponentDidMount(o.bind(this)),this._aspectSiteAPI.registerToUrlPageChange(o.bind(this))}return r.sendRequest=function(e){new window.Image(0,0).src=e},r.CHUNK_SIZE=1,r.CHUNK_INTERVAL=100,r}.apply(t,n))||(e.exports=a)},1813:function(e,t,i){var n,a;n=[i(0),i(1)],void 0===(a=function(e,t){"use strict";var i="tpaModalAspect";function n(t){this.aspectSiteApi=t,e.bindAll(this,e.functionsIn(this))}return n.prototype={getComponentsToRender:function(){var t=function(t){var n=t.getAspectGlobalData(i);return e.get(n,"modalStructure")}(this.aspectSiteApi);if(t){var n=this.aspectSiteApi.getAspectGlobalData(i);return[{structure:t,props:{compData:n.modalData,onCloseCallback:n.modalOnClose,key:t.id}}]}return null},showModal:function(e,n){this.aspectSiteApi.getSiteData().isMobileView()&&("LIGHT_BOX"===e.theme?(this.aspectSiteApi.exitFullScreenMode(),this.aspectSiteApi.setSiteRootHiddenState(!0)):(this.aspectSiteApi.enterFullScreenMode({scrollable:!1}),this.aspectSiteApi.setSiteRootHiddenState(!1))),this.aspectSiteApi.setSiteRootAriaHiddenState(!0),this.aspectSiteApi.getComponentById("SITE_BACKGROUND").setAriaHiddenState(!0),this.aspectSiteApi.setAspectGlobalData(i,{modalStructure:{componentType:"wysiwyg.viewer.components.tpapps.TPAModal",type:"Component",id:t.guidUtils.getUniqueId(),skin:"wysiwyg.viewer.skins.TPAModalSkin"},modalData:e,modalOnClose:n}),this.aspectSiteApi.forceUpdate()},removeModal:function(){this.aspectSiteApi.getSiteData().isMobileView()&&(this.aspectSiteApi.exitFullScreenMode(),this.aspectSiteApi.setSiteRootHiddenState(!1)),this.aspectSiteApi.setSiteRootAriaHiddenState(!1),this.aspectSiteApi.getComponentById("SITE_BACKGROUND").setAriaHiddenState(!1),this.aspectSiteApi.setAspectGlobalData(i,{modalStructure:null})}},n}.apply(t,n))||(e.exports=a)},1814:function(e,t,i){var n,a;n=[i(0),i(1),i(6),i(42)],void 0===(a=function(e,t,i,n){"use strict";var a="tpaMobileViewportAspect",o=function(t){this.aspectSiteAPI=t,e.bindAll(this,e.functionsIn(this)),this.aspectSiteAPI.registerToSiteReady(this.fixMobileViewportIfNeeded),this.aspectSiteAPI.registerToUrlPageChange(this.fixMobileViewportIfNeeded)};return o.prototype={fixMobileViewportIfNeeded:function(){var e=this.aspectSiteAPI.getSiteData();if(i.isOpen("sv_tpaMobileViewportFix",e)){var o=this.aspectSiteAPI.getAspectGlobalData(a);if(n.services.clientSpecMapService.isCurrentPageFullResponsive(e)){if(!o||!o.isResponsive){var r={isResponsive:!0};this.aspectSiteAPI.setAspectGlobalData(a,r),t.mobileViewportFixer.fixViewportTag(e,r)}}else o&&o.isResponsive&&(this.aspectSiteAPI.setAspectGlobalData(a,null),t.mobileViewportFixer.fixViewportTag(e,null))}}},o}.apply(t,n))||(e.exports=a)},1815:function(e,t,i){var n,a;n=[i(0)],void 0===(a=function(e){"use strict";var t=function(t){this.siteAspectsSiteAPI=t,e.bindAll(this,e.functionsIn(this))};return t.prototype={updateSectionUrlState:function(e,t){var i=this.siteAspectsSiteAPI.getComponentById(e);i&&i.setState({sectionUrlState:t})},updatePushState:function(e,t){var i=this.siteAspectsSiteAPI.getComponentById(e);i&&i.setState({pushState:t})},updateSectionUrlParams:function(e,t){var i=this.siteAspectsSiteAPI.getComponentById(e);i&&i.setState({sectionUrlParams:t})},reportStateChanged:function(e,t){var i=this.siteAspectsSiteAPI.getComponentById(e);i&&i.reportStateChanged(t)}},t}.apply(t,n))||(e.exports=a)},1816:function(e,t,i){var n,a;n=[i(0)],void 0===(a=function(e){"use strict";function t(t){this.aspectSiteApi=t,this.aliveTpaComponentPromises={},this.handleComponentIsAlive={},e.bindAll(this,e.functionsIn(this))}return t.prototype={clearComponentIsAlive:function(e){delete this.handleComponentIsAlive[e],delete this.aliveTpaComponentPromises[e]},markComponentIsAlive:function(e){var t=function(e,t){return e.getComponentById(t)}(this.aspectSiteApi,e);this.handleComponentIsAlive[e]?this.handleComponentIsAlive[e](t):this.aliveTpaComponentPromises[e]=Promise.resolve(t)},getComponentWhenReady:function(e){var t=this.aliveTpaComponentPromises;return t[e]=t[e]||new Promise(function(t){this.handleComponentIsAlive[e]=t}.bind(this)),t[e]}},t}.apply(t,n))||(e.exports=a)},1817:function(e,t,i){var n,a;n=[i(0),i(42)],void 0===(a=function(e,t){"use strict";var i=function(e,t){this._listeners={},this._siteAPI=e,this._currentPageId=t||this._siteAPI.getSiteData().getCurrentUrlPageId(),this._siteAPI.registerToUrlPageChange(this.notifyPageChanged.bind(this))};return i.prototype={notifyPageChanged:function(){var i=this._siteAPI.getSiteData().getCurrentUrlPageId(),n=this._currentPageId;e.forEach(this._listeners,function(a){e.forEach(a,function(a){var o=a.comp.props.rootId;if(a.comp._isMounted&&function(e,i,n,a){return e.type===t.common.supportedSiteEvents.PAGE_NAVIGATION||e.type===t.common.supportedSiteEvents.PAGE_NAVIGATION_CHANGE||e.type===t.common.supportedSiteEvents.PAGE_NAVIGATION_IN&&a===i||e.type===t.common.supportedSiteEvents.PAGE_NAVIGATION_OUT&&a===n}(a,i,n,o)){var r={toPage:i,fromPage:n,isAppOnPage:o===i,wasAppOnPage:o===n},s=e.get(this._siteAPI.getSiteData().getExistingRootNavigationInfo(i),"routerPublicData");s&&(r.routerData=s),a.comp.sendPostMessage({intent:"addEventListener",eventType:a.type,params:r})}}.bind(this))}.bind(this)),this._currentPageId=i},registerToPageChanged:function(e,t){var i=this._listeners[e.props.id];i||(i=this._listeners[e.props.id]=[]),i.push({comp:e,type:t})},unregisterToPageChanged:function(e){delete this._listeners[e.props.id]}},i}.apply(t,n))||(e.exports=a)},1818:function(e,t,i){var n,a,o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}n=[i(0),i(67),i(1),i(42)],void 0===(a=function(e,t,i,n){"use strict";var a,p="tpa_public_api_",c=3e4,u="Widget",g=(s(a={},"Page",n.common.utils.isTPASection),s(a,u,n.common.utils.isGluedWidget),a),d={TIMEOUT:"Callback Timeout Expired",COMP_NOT_FOUND:"ComponentId Not Found",APP_NOT_FOUND:"ApplicationId Not Found",COMP_NOT_SUPPORTED:"Component Not Supported"};function l(e){return p+e}function f(t,a,o){var r=t.getPageData().id,s=i.siteConstants.MASTER_PAGE_ID,p=e.get(n.common.utils.getAppDataByAppDefinitionId(t,a),"applicationId");if(!p)return{compId:null,error:d.APP_NOT_FOUND};var c=t.getCompsDataOnPage(r).concat(t.getCompsDataOnPage(s)).filter(function(t){return function(t,i){return e.get(t,"applicationId")===i.toString()}(t,p)});if(0===c.length)return{compId:null,error:d.COMP_NOT_FOUND};var u=c.filter(function(t){return function(t,i){return e.get(g,i,function(){return!1})(t)}(t,o)});return 0===u.length?{compId:null,error:d.COMP_NOT_SUPPORTED}:u.length>1?{compId:null,error:d.COMP_NOT_SUPPORTED}:{compId:e.get(u[0],"compId")}}function m(t){return e.get(t.getSiteData().getExistingRootNavigationInfo(),"tpaInnerRoute")}function v(e,t){return n.common.utils.isTPASection({componentType:e.getComponentType(t)})}var I=function(){function t(e,i,n){var a=this;r(this,t),this.compId=e,this.isTPASection=i,this.getCurrentSectionStateFunc=n,this.resolved=!1,this.rejected=!1,this.tpaSectionState=void 0,this.subscribers=[],this.timeoutId=setTimeout(function(){return a.reject()},c)}return o(t,[{key:"resolve",value:function(){this.resolved=!0,this.invokeSubscribers(l(this.compId)),clearTimeout(this.timeoutId),this.isTPASection&&(this.tpaSectionState=this.getCurrentSectionStateFunc())}},{key:"reject",value:function(){this.rejected=!0,this.invokeSubscribers(null,d.TIMEOUT)}},{key:"reset",value:function(){this.resolved=!1,this.rejected=!1,this.subscribers=[]}},{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"invokeSubscribers",value:function(t,i){e.invokeMap(this.subscribers,e.call,null,t,i),this.subscribers=[]}}]),t}();return function(){function i(t){r(this,i),this.siteAPI=t,this.apiStore={},this.getCurrentSectionStateFunc=e.partial(m,this.siteAPI)}return o(i,[{key:"registerApi",value:function(e,i){if(!this.apiStore[i]){var n=v(this.siteAPI,i);this.apiStore[i]=new I(i,n,this.getCurrentSectionStateFunc)}this.apiStore[i].resolve(),t.api.request(l(i),{initiator:e}).then(function(e){return t.api.set(l(i),e)})}},{key:"requireComponentAPI",value:function(e,t){var i=v(this.siteAPI,e);this.apiStore[e]||(this.apiStore[e]=new I(e,i,this.getCurrentSectionStateFunc)),i&&this.getCurrentSectionStateFunc()!==this.apiStore[e].tpaSectionState&&this.apiStore[e].reset(),this.apiStore[e].resolved?t(l(e)):this.apiStore[e].rejected?t(null,d.TIMEOUT):this.apiStore[e].subscribe(t)}},{key:"requireSingletonAPI",value:function(e,t,i){var n=f(this.siteAPI,e,t);n.compId?this.requireComponentAPI(n.compId,i):i(null,n.error)}}]),i}()}.apply(t,n))||(e.exports=a)},1819:function(e,t,i){var n,a;n=[i(0),i(1820)],void 0===(a=function(e,t){"use strict";var i=function(e){this._siteAPI=e};return i.prototype={callHandler:function(e,i){var n=i.type;return t[n].call(this,e,i)}},i}.apply(t,n))||(e.exports=a)},1820:function(e,t,i){var n,a;n=[i(0),i(42)],void 0===(a=function(e,t){"use strict";return{sectionsUrls:function(i,n){var a=t.services.pageService.mapPageToWidgets(i),o=n.compData,r=i.getSiteData().getClientSpecMap()[o.applicationId].applicationId;if(e.isEmpty(a)||e.isUndefined(a[r]))return null;var s=a[r];return e.map(s,function(e){return{tpaPageId:e.tpaPageId,url:i.getPageUrlFor(e.pageId)}})}}}.apply(t,n))||(e.exports=a)},3:function(e,t){e.exports=i},30:function(e,t){e.exports=p},319:function(e,t,i){var n,a;n=[i(9),i(0)],void 0===(a=function(e,t){"use strict";return{measureTPA:function(i,n,a,o){var r=e(a[i]);t.set(n.custom,[i,"hasIframe"],Boolean(a[i+"iframe"]));var s=parseInt(r.css("min-height"),10),p=parseInt(r.css("min-width"),10),c=r.attr("data-ignore-anchors");s&&"true"!==c&&(n.minHeight[i]=s,n.height[i]=s),s&&"true"===c&&(n.minHeight[i]=o.structure.layout.height,n.height[i]=o.structure.layout.height),p&&(n.minWidth[i]=p,n.width[i]=p)}}}.apply(t,n))||(e.exports=a)},33:function(e,t){e.exports=c},42:function(e,t){e.exports=u},537:function(e,t,i){var n,a;n=[i(0),i(42)],void 0===(a=function(e,t){"use strict";var i="fixed";function n(t,i){var n=t,a=i.height.screen,o=i.width.screen,r=i.custom.WIX_ADStop;r&&(n=function(t,i,n){var a,o;return o=i,(a=n).right<o.left||a.left>o.right||a.bottom<o.top||a.top>o.bottom||!e.isNumber(t.top)||(t.top=(t.top||0)+(n.bottom-i.top)),t}(n,function(t,i,n){return{top:e.isNumber(t.top)?e.parseInt(t.top):n-t.height,bottom:e.isNumber(t.bottom)?n-e.parseInt(t.bottom):e.parseInt(t.top)+t.height,right:e.isNumber(t.right)?i-e.parseInt(t.right):e.parseInt(t.left)+t.width,left:e.isNumber(t.left)?e.parseInt(t.left):i-t.width}}(n,o,a),r));return n}function a(a,o,r,s,p){if(p.isMobileView())(function(i,n){var a=i.dataItem,o=n[a.applicationId],r=t.common.metaData.PERMITTED_FULL_SCREEN_TPAS_IN_MOBILE;return o&&e.includes(r,o.appDefinitionId)})(s,p.getClientSpecMap())&&o.css(a,{position:"fixed",margin:"0",top:"0",left:"auto",width:r.width.screen,height:"100%",zIndex:2e3});else{var c=function(t,n,a){var o={};return e.forEach(a,function(a){var r=n[a]&&n[a][t],s=a;e.isUndefined(r)||(0===a.indexOf(i)&&(s=s.slice(i.length).toLowerCase()),o[s]=r)}),o}(a,r,["position","fixedTop","fixedLeft","right","bottom","width","height"]);c=n(c,r),c=e.omit(c,["width","height"]),o.css(a,c)}}return function(){this.patchGluedWidget=a}}.apply(t,n))||(e.exports=a)},538:function(e,t,i){var n,a;n=[i(0),i(539)],void 0===(a=function(e,t){"use strict";var i=300,n=120;function a(e){return"number"==typeof e?e:e&&parseFloat(e)||0}function o(e){return(e>2||e<-2)&&(e=0),e}return{getGluedWidgetMeasurements:function(r,s,p,c,u,g){var d=o(s.props.horizontalMargin),l=o(s.props.verticalMargin),f=s.props.placement||t.getDefaultPlacement(s.data,r),m=function(t,o,r,s,p,c,u,g){c=a(c),u=a(u);var d={},l=void 0;function f(){if(c>=-1&&c<=1){var e=s/2-o/2,t=c*((s-2*n)/2-o/2);d.top=e+t}else if(c<-1&&c>=-2)l=2+c,d.top=l*n;else if(c>1&&c<=2){l=2-c;var i=Math.floor(l*n);d.top=s-i-o}}function m(){if(u>=-1&&u<=1){var e=r/2-t/2,n=u*((r-2*i)/2-t/2);d.left=e+n}else if(u>1&&u<=2){l=2-u;var a=Math.floor(l*i);d.left=r-a-t}else u<-1&&u>=-2&&(l=2+u,d.left=l*i)}switch(p){case"TOP_LEFT":d.top=0,d.left=0,d.bottom="auto";break;case"TOP_RIGHT":d.top=0,d.right=0,d.bottom="auto";break;case"TOP_CENTER":d.top=0,d.bottom="auto",m();break;case"CENTER_RIGHT":d.right=0,f();break;case"CENTER_LEFT":d.left=0,f();break;case"BOTTOM_LEFT":d.bottom=0,d.left=0,d.top="auto";break;case"BOTTOM_CENTER":d.bottom=0,d.top="auto",m();break;case"BOTTOM_RIGHT":default:d.bottom=0,d.right=0,d.top="auto"}return e.defaults(d,{position:g?"absolute":"fixed",top:"0",left:"0"})}(s.layout.width,s.layout.height,p,c,f,l,d,g),v=function(t,i){var n={};return i&&i>0&&e.isNumber(t.bottom)&&t.bottom<i&&(n.bottom=i),n}(m,u||0),I=e.assign(m,v);return 0===I.right&&(I.left=p-s.layout.width),0===I.bottom&&(I.top=c-s.layout.height-(u||0)),I}}}.apply(t,n))||(e.exports=a)},539:function(e,t,i){var n;void 0===(n=function(){"use strict";return{getDefaultPlacement:function(e,t){var i=e.applicationId,n=e.widgetId,a=t[i];if(a){var o=a.widgets[n];if(o)return(o.gluedOptions||{horizontalMargin:0,placement:"BOTTOM_RIGHT",verticalMargin:0}).placement}}}}.apply(t,[]))||(e.exports=n)},540:function(e,t,i){var n,a;n=[i(0),i(9),i(42),i(6),i(33)],void 0===(a=function(e,t,i,n,a){"use strict";return{patchTPASection:function(e,t,o,r,s){var p=o.height[e],c=r.dataItem,u=s.getClientSpecMap()[c.applicationId],g=i.services.clientSpecMapService.isFullPage(c,u),d=i.services.clientSpecMapService.isFullPageDesktopOnly(c,u)&&!s.isMobileView();if(u&&(g||d)){var l={position:"fixed",left:"0px",marginLeft:"0px",top:"0px",right:"0px",marginRight:"0px",bottom:"0px"};s.isMobileView()?(p=o.height.screen-o.siteOffsetTop,l=function(e,t,i){var n=t.height.screen-t.siteOffsetTop;return e.height=n+"px",e.minHeight=n+"px",e.top=t.siteOffsetTop+"px",i.isViewerMode()||(e.left=void 0,e.right=void 0),e}(l,o,s)):n.isOpen("displayWixAdsNewVersion",s)&&(l.top=a.spaceCalculationsRegardingWixAds.getFirstUnoccupiedTopCoordinate(o)),t.css(e,l)}var f=o.width[e],m=s.os.ios;o.custom[e].hasIframe&&(n.isOpen("sv_tpaMobileViewportFix",s)&&i.services.clientSpecMapService.isCurrentPageFullResponsive(s)?t.css(e+"iframe",{position:"fixed",height:"calc(100% - "+o.siteOffsetTop+"px)",left:0}):m&&t.css(e+"iframe",{width:f,height:p}))}}}.apply(t,n))||(e.exports=a)},541:function(e,t,i){var n,a;n=[i(0)],void 0===(a=function(e){"use strict";var t={TPA_MESSAGE:"TPA",TPA_MESSAGE_PREVIEW:"TPA_PREVIEW",TPA_MESSAGE2:"TPA2",TPA_RESPONSE:"TPA_RESPONSE",TPA_PREVIEW_RESPONSE:"TPA_PREVIEW_RESPONSE",PINGPONG_PREFIX:"pingpong:"},i=function(e,t,i){var n="";try{n=JSON.stringify(t)}catch(e){return}e.postMessage||(e=e.contentWindow),e.postMessage(n,i||"*")},n=function(e,n,a){return function(o){try{i(e,{intent:a||t.TPA_RESPONSE,callId:n.callId,type:n.type,res:o,status:!0})}catch(e){}}},a=function(e){return e===t.TPA_MESSAGE||e===t.TPA_MESSAGE2},o=function(e,t,i){var n=!0;return t.isExperimentOpen("sv_postmessage_security")&&(n=s(e,t,i)||r(t,i)||p(t,i)),n},r=function(e,t){return 0===(e.getPageUrl()||"").indexOf(t)},s=function(t,i,n){var a=i.getComponentById(t);return 0===e.get(a,"refs.iframe.src","").indexOf(n)},p=function(e,t){var i=e.getSiteData().getServiceTopologyProperty("baseDomain")||"";return i=i.replace(/\./gi,"\\."),new RegExp("[./]{1}"+i+"$","ig").test(t)};return{Intents:t,callPostMessage:i,generateResponseFunction:n,isTPAMessage:a,fixOldPingPongMessageType:function(e){return e.replace(t.PINGPONG_PREFIX,"")},handleTPAMessage:function(i,r,s,p){var c=function(e){var t=void 0;try{e.data?t=JSON.parse(e.data):e.originalEvent&&e.originalEvent.data&&(e=e.originalEvent,t=JSON.parse(e.data))}catch(e){}return t}(p),u=p.originalEvent?p.originalEvent.origin:p.origin;if(c&&a(c.intent)){if(i)s(i,c,n(p.source,c));else if(o(c.compId,r,u)){var g=function(e){return e.getSiteData().viewMode}(r);!function(e,t){return!("preview"===e&&{getSectionUrl:!0,siteInfo:!0,navigateToPage:!0,getExternalId:!0,smRequestLogin:!0,getValue:!0,getValues:!0,getPublicData:!0,getCurrentPageAnchors:!0,getComponentInfo:!0,navigateToSectionPage:!0,isAppSectionInstalled:!0,getStateUrl:!0,getSitePages:!0,getSiteMap:!0,smCurrentMember:!0,refreshCurrentMember:!0,onReady:!0}[t.type])}(g,c)&&function(t){return"preview"===t.getSiteData().viewMode&&e.get(window,"documentServices.tpa.__privates.areDocumentServicesHandlersReady")&&window.documentServices.tpa.__privates.areDocumentServicesHandlersReady()}(r)||(c.origin="site"===g?"viewer":g,s(r,c,n(p.source,c)))}}else c&&c.intent===t.TPA_MESSAGE_PREVIEW&&(i?s(i,c,n(p.source,c,t.TPA_PREVIEW_RESPONSE)):o(c.compId,r,u)&&s(r,c,n(p.source,c,t.TPA_PREVIEW_RESPONSE)))}}}.apply(t,n))||(e.exports=a)},542:function(e,t,i){var n,a;n=[i(9),i(0),i(1),i(30),i(3),i(10),i(11),i(13),i(42),i(543),i(544),i(1803),i(1804),i(545),i(6)],void 0===(a=function(e,t,i,n,a,o,r,s,p,c,u,g,d,l,f){"use strict";var m=o.logger,v=s.tpaWarmup,I=p.common.metaData.PERF_CATEGORY,h=a.activityTypes.TPAActivity,S=a.activityService,P="QUICK_ACTION_BAR",A="notifyWidget";function y(e){return e.getSiteAspect("siteMembers")}var T=function(e,t,i){var n={},a=e.getSiteData().getDataByQuery(e.getSiteData().getCurrentUrlPageId()),o=e.getSiteData().getCurrentUrlPageTitle();p.common.utils.sdkVersionIsAtLeast(t.version,"1.42.0")?n.pageTitle=o:(n.siteTitle=o,n.pageTitle=a.title),n.pageTitleOnly=e.getSiteData().getCurrentUrlPageName(),n.siteDescription=a.descriptionSEO,n.siteKeywords=a.metaKeywordsSEO;var r=e.getSiteData().currentUrl;n.url=r.full,n.baseUrl=e.getSiteData().getExternalBaseUrl(),n.referer=window.document.referrer,i(n)},C=function(e,t){e&&e({error:{message:t}})},D=function(e,i,n){var a={filterHideFromMenuPages:!0,includePagesUrl:t.get(i,"data.includePagesUrl",!1),includeIsHomePage:!0,enhancedInfo:!1};n(p.sitePages.getSitePagesInfoData(e.getSiteData(),a))},b=function(e,t,i){i(p.sitePages.getSitePagesInfoData(e.getSiteData(),{filterHideFromMenuPages:!0,includePagesUrl:!1,includeIsHomePage:!1,enhancedInfo:!0}))},w=function(e,i,n){var a=void 0,o=e.getComponentById(i.compId),r=t.get(i,"data.sectionIdentifier.appDefinitionId");r?a=p.common.utils.getAppDataByAppDefinitionId(e,r):o&&(a=o.getAppData());var s=t.get(a,"applicationId"),u=p.services.pageService.mapPageToWidgets(e),g=t.get(u,s),d=e.getSiteData().getPrimaryPageId();c.navigateToSection(e,a,i,g,d,function(i){var n=e.getComponentsByPageId(i),a=t.find(n,"isTPASection");return t.get(a,"props.id")},e.getSiteData().isDynamicPage,n,t.partial(ae,e,a))},E=function(e,i,n,a,o){var r=e.getSiteData();if(a=a||r.getFocusedRootId(),(i=i||M(e,n,a))&&(_(i)||i.props.rootId===a)){var s=R(i,e);r.animations.animate("BaseScroll",e.getSiteContainer(),1,0,{y:s.y,x:s.x,callbacks:{onComplete:o}})}else{o({error:{message:(t.isEmpty(a)?"Current page":'Page id "'+a+'"')+' does not contain the component id "'+n+'".'}})}},_=function(e){return"masterPage"===e.props.rootId},M=function(e,t,i){return e.getComponentsByPageId(i)[t]},R=function(e,i){var n=i.getSiteData(),a=r.findDOMNode(e),s=n.measureMap.siteMarginTop||0,p=o.domMeasurements.getElementRect(a),c=p.top+s;t.get(n,"measureMap.custom.SITE_HEADER.isFixedPosition")&&(c-=n.measureMap.height.SITE_HEADER);var u=o.scrollAnchors.normalizeYOffset(c,n);return{x:p.left,y:u}},O=function(e,i){var n=e.getBoundingClientRect(),a=t(n).pick(["left","right","top","bottom","height","width"]).mapValues(function(e){return Math.floor(e)}).value();return i&&(a.top-=i),a},x=function(e,t){return{x:e.left,y:e.top-t}},U=function(e){return t.isString(e)&&/^[0-9]+%$/.test(e)},N=function(e,t){var i=t.data.eventKey;if("QUICK_ACTION_TRIGGERED"!==i){var n=e.getComponentById(t.compId);n&&n.isCompListensTo&&!n.isCompListensTo(i)&&n.startListen(i)}else!k(e,i,t.compId)&&e.getSiteData().isViewerMode()&&B(e,t.compId)},k=function(e,i,n){var a=F(e,n),o=e.getRuntimeDal().getActionsAndBehaviors(P),r=t(o).filter({action:{sourceId:P,name:a}}).filter({behavior:{targetId:n}}).filter({behavior:{name:A}}).value();return!t.isEmpty(r)},B=function(e,t){var i=function(e,t){return{action:{type:"comp",name:t,sourceId:P},behavior:{type:"comp",targetId:e,name:A,params:{sourceId:P,action:t}}}}(t,F(e,t));e.getRuntimeDal().addActionsAndBehaviors(P,i)};var W=function(e,t){var i=t.data.eventKey||t.data;if("QUICK_ACTION_TRIGGERED"!==i){var n=e.getComponentById(t.compId);n&&n.stopListen(i)}else L(e,t.compId)},L=function(e,t){var i=F(e,t);e.getRuntimeDal().removeActionsAndBehaviors(P,{action:{name:i}})};function F(e,i){var n=e.getComponentById(i),a=t.get(n,"props.compData.applicationId");return e.getSiteData().getClientSpecMap()[a].appDefinitionId}var G=function(e,i,n,a){if(p.common.utils.isTPASection(i)){i.setState({pushState:a});var o=i.getAppData(),r=t.get(i,"props.compData.widgetId")||t.get(p.services.clientSpecMapService.getMainSectionWidgetData(o),"widgetId"),s=e.getSiteData().getPrimaryPageId();c.navigateWithoutClosingPopupIfPossible(e,{pageId:n,tpaInnerRoute:a,transition:"none"},s,void 0,void 0,void 0,t.partial(ae,e,o,r,i.props.id))}},V=function(e,t,i,n){i.getMemberDetails(function(t){null!==t?(n(t),e&&e.setSiteMemberDataState(null)):e?e.setSiteMemberDataState({callback:n}):n(null)})},H=function(e,t,i){var n=e.getComponentById(t.compId),a=y(e);a.isLoggedIn()?V(n,0,a,function(e){i(e)}):i(null)},K=function(e,i){var n=t.get(i,"data.pixelId"),a=t.get(i,"data.pixelType");n&&"FACEBOOK"===a&&e.initFacebookRemarketing(n)},q=function(e,i){var n=t.get(i,"data",{}),a=t.get(i,"data.eventName");a&&(delete n.eventName,e.fireFacebookRemarketingPixel(a,n))},j=function(e){var t=e.getSiteData();return{hubSecurityToken:t.getHubSecurityToken(),svSession:t.getSvSession(),metaSiteId:t.getMetaSiteId(),currentUrl:t.getCurrentUrl()}},z=function(e,i){var n=p.common.utils.getAppData(e,i.compId),a=i.data;return{type:t.get(a,"activity.type")||"TPA",appDefinitionId:n.appDefinitionId||"TPA",info:t.get(a,"activity.info")||{},details:t.get(a,"activity.details")||{},contactUpdate:t.get(a,"activity.contactUpdate")||{},instance:n.instance}},Q=function(e,n,a){var o=p.common.utils.getAppDefId(e,n.compId);i.loggingUtils.performance.start("appIsAlive "+o,I);var r=e.getComponentById(n.compId);if(r&&r.setAppIsAlive&&r.setAppIsAlive(),t.get(r,"hasOrigComponent"))try{a(X(e,r)),i.loggingUtils.performance.finish("appIsAlive "+o,I),i.loggingUtils.performance.finish("getStyleParams "+o,I)}catch(t){e.reportBI(p.bi.events.APP_IS_ALIVE_ERROR,{app_id:o,errorMessage:t.toString()})}},X=function(e,i){var n=e.getSiteData(),a=n.getAllStylesFromPossiblyRenderedRoots(),r=i&&i.hasOrigComponent()?e.getComponentById(i.getOrigComponentId()):i,s=t.get(r,"props.structure.styleId"),p=n.rendererModel.siteInfo.documentType,c=n.getDataByQuery("masterPage").characterSets,u=n.isVisualFocusEnabled(),g=o.styleUtils.getStyleDataToPassIntoApp(s,a,n.santaBase,p,c,n.serviceTopology,!0);return t.assign(g,{isVisualFocusEnabled:u})},J=function(e,t,i){var n=e.getComponentById(t.compId).props.compData,a=e.getRootOfComponentId(t.compId);i(v.tpaDataService.getValue(e.getSiteData(),t,a,n))},Y=function(e,t,i){var n=e.getSiteData(),a=e.getRootOfComponentId(t.compId),o=e.getComponentById(t.compId,a).props.compData,r={};r.APP=v.tpaDataService.getTpaDataContent(n,"tpaData-"+o.applicationId,"masterPage"),r.COMPONENT=v.tpaDataService.getTpaDataContent(n,o.tpaData,a),i(r)},Z=function(e,i,n){var a=t.uniq(i.data.keys),o=e.getSiteData(),r=e.getRootOfComponentId(i.compId),s=e.getComponentById(i.compId,r).props.compData,p=i.data.scope,c=void 0;if(p===v.tpaDataService.SCOPE.APP){var u=v.tpaDataService.getTpaDataContent(o,"tpaData-"+s.applicationId,"masterPage");c=t.pick(u,a)}else{var g=v.tpaDataService.getTpaDataContent(o,s.tpaData,r);c=t.pick(g,a)}if(!t.isEmpty(c)&&t(c).keys().isEqual(a))n(c);else{var d=t.keys(c);n({error:{message:"keys "+t(d).xor(a).intersection(a).value()+" not found in "+p+" scope"}})}},$=function(e,i){return{width:t.get(e,"measureMap.width.WIX_ADS"+i),height:t.get(e,"measureMap.height.WIX_ADS"+i),top:t.get(e,"measureMap.top.WIX_ADS"+i),left:t.get(e,"measureMap.left.WIX_ADS"+i)}};function ee(e,i,n){var a=null,o=e.getComponentById(i,n);if(o){var r=t.get(o.props,"compData.applicationId")||null;a=e.getSiteData().getClientSpecMapEntry(r)||null}return a||{}}var te=function(e,t){var i=e.getComponentById(t).props.compData;return i&&i.id},ie=function(e,i,n){var a=e.getSiteData(),o=void 0,r=t.get(i,["data","appDefinitionId"]);r?o=p.services.clientSpecMapService.getAppDataByAppDefinitionId(a,r):o=e.getComponentById(i.compId).getAppData();var s=t.get(o,"applicationId"),c=p.services.pageService.mapPageToWidgets(e),u=t.get(c,s);n(t.some(u,{tpaPageId:t.get(i,["data","sectionId"])}))},ne=function(e,i,n){var a=e.getSiteData(),o=t.get(i,["data","appDefinitionId"]),r=p.services.clientSpecMapService.getAppDataByAppDefinitionId(a,o);if(r){var s=r.instance.split(".");n(JSON.parse(atob(s[1])).vendorProductId)}else n(null)},ae=function(e,i,n,a){var o=e.getSiteData().biData,r=o.getTime(),s={compId:a,pageId:o.getPageId(),pageNo:o.getPageNumber(),loadingTime:r.loadingTime,totalLoadingTime:r.totalLoadingTime};t.get(i,"isWixTPA")?(s.widgetId=n,s.appDefinitionId=t.get(i,"appDefinitionId")):(s.externalWidgetId=n,s.externalAppDefinitionId=t.get(i,"appDefinitionId")),m.reportBI(e.getSiteData(),p.bi.events.APP_STATE_CHANGED,s)};return t.merge({waitForWixCodeWorkerToBeReady:function(e,t,i){var n=e.getSiteAspect("WidgetAspect"),a=e.getSiteData(),o=a.getCurrentUrlPageId(),r=f.isOpen("sv_handleFailingWixCodeSdk",a)?n.isContextReadyOrLifeCycleFailed(o):n.isContextReady(o),s=e.getSiteAspect("wixCodeWidgetAspect");s&&s.isAppInitiated()?r?i({}):n.registerToOnWidgetReady(o,function(){i({})}):i({error:!0})},siteInfo:T,heightChanged:function(e,i){var n="number"==typeof i.data?i.data:i.data.height;if(n>1e6){var a={height:n};m.reportBI(e.getSiteData(),p.bi.errors.SDK_SET_HEIGHT_ERROR,a)}var o={height:n,ignoreAnchors:i.data.overflow},r=e.getComponentById(i.compId);t.invoke(r,"registerReLayout"),t.invoke(r,"setState",o)},registerEventListener:N,removeEventListener:W,navigateTo:function(e,n,a){var o=t.get(n,"data.link");i.linkUtils.navigateToLink(e,o,a)},navigateToPage:function(e,i,n){var a=e.getSiteData().getPrimaryPageId(),r=e.getSiteData().getAllPageIds();c.navigateToPage(e,i,a,r,function(t){var i=p.common.utils.Constants.TOP_PAGE_ANCHOR_PREFIX+t;return o.scrollAnchors.getPageAnchors(e.getSiteData(),t,i)},t.partial(te,e),n)},smRequestLogin:function(e,i,n){var a=e.getComponentById(i.compId),o=y(e);if(o.isLoggedIn())V(a,0,o,function(e){n({authResponse:!0,data:e})});else{var r=t.get(i,"data.mode"),s=r&&"login"===r,c=t.get(i,"data.language","en"),u=void 0;t.get(i,"data.callOnCancel")&&(u=function(){n({wasCancelled:!0})}),o.showAuthenticationDialog({successCallback:function(e){n({authResponse:!0,data:e})},cancelCallback:u,language:c,showLoginDialog:s,appId:p.common.utils.getAppDefId(e,i.compId),checkCommunityCheckbox:t.get(i,"data.checkCommunityCheckbox")})}},smCurrentMember:H,refreshCurrentMember:function(e){var t=y(e);t.isLoggedIn()&&t.getMemberDetails(null,null,!0)},authorizeMemberPages:function(e,t,i){var n=y(e),a=i;n.isLoggedIn()&&n.authorizeMemberPages(a,function(){return i({error:{message:"Failed to get authorized pages"}})})},scrollBy:function(e,t,i){e.scrollSiteBy(t.data.x,t.data.y,i)},scrollTo:function(e,i,n){i.data.scrollAnimation?e.getSiteData().animations.animate("BaseScroll",e.getSiteContainer?e.getSiteContainer():e._site.props.getSiteContainer(),1,0,{y:i.data.y,x:i.data.x,callbacks:{onComplete:function(){n&&n()}}}):e.getSiteAspect("windowScrollEvent").scrollSiteTo(i.data.x,i.data.y,t.isFunction(n)&&n)},navigateToComponent:function(e,n,a){var o=n.data.pageId,r=n.data.compId,s=e.getSiteData().getFocusedRootId(),p=e.getComponentById(r);if(p&&"wysiwyg.viewer.components.tpapps.TPAGluedWidget"===p.props.structure.componentType)a({error:{message:"Navigation to glued widget not supported."}});else if(t.isEmpty(o)||o===s)E(e,p,r,o,a);else{var c=e.getSiteData().getAllPageIds();i.linkUtils.navigateToPage(e,o,c,n.data.noPageTransition,void 0,E.bind(null,e,p,r,o,a),a)}},registerCampaignPixel:K,reportCampaignEvent:q,postActivity:function(e,t){var i=e.getComponentById(t.compId),n=j(e),a=z(e,t),o=function(e){i.sendPostMessage({intent:"TPA_RESPONSE",callId:t.callId,type:t.type,res:{response:{activityId:e.response.activityId,contactId:e.response.contactId},status:e.status},status:e.status,compId:t.compId})},r=new h(n,a);S.reportActivity(e.getSiteData().getExternalBaseUrl(),r,function(t){t.userSessionToken&&e.setUserSession(t.userSessionToken),o({status:!0,response:t})},function(e){var t={status:e.status,statusText:e.statusText,responseText:e.responseText};o({status:!1,response:t})})},getCurrentPageId:function(e,t,i){i(e.getSiteData().getCurrentUrlPageId())},getCurrentPageNavigationInfo:function(e,t,i){var n=e.getSiteData().getRootNavigationInfo(),a={};n.routerDefinition?(a.innerRoute=n.innerRoute,a.type="DynamicPageLink",a.routerId=n.routerDefinition.routerId):(a.type="PageLink",a.pageId=n.pageId),i(a)},getUserSession:function(e,t,i){i(e.getUserSession())},boundingRectAndOffsets:function(i,n,a){var o=i.getSiteData(),s=i.getComponentById(n.compId),p=r.findDOMNode(s),c=0;t.get(o,"measureMap.custom.SITE_HEADER.isFixedPosition")&&(c=o.measureMap.height.SITE_HEADER);var u=i.getRenderFlag("siteScale")||1;a({rect:O(p,c),offsets:x(e(p).offset(),c),scale:u})},navigateToSectionPage:w,getSitePages:D,getSiteMap:b,appIsAlive:Q,openModal:function(e,t,i){var n=t.data||{};l.openModal(e,t.compId,n.url,n.width,n.height,n.theme,i,n.title)},openPopup:function(e,t,i){var n=t.data||{};l.openPopup(e,t.compId,n.url,n.width,n.height,n.theme,n.position,!1,i)},openPersistentPopup:function(e,t,i){var n=t.data,a=n.url,o=n.width,r=n.height,s=n.theme,p=n.position;l.openPopup(e,t.compId,a,o,r,s,p,!0,i)},closeWindow:function(e,t){var i=e.getComponentById(t.compId);i&&i.hide&&i.hide(t.data)},setFullScreenMobile:function(e,i,n){if(e.getSiteData().isMobileView()){var a=i.data.isFullScreen,o=i.compId,r=e.getComponentById(o);!function(e,i){var n=ee(e,i);return t.includes(p.common.metaData.PERMITTED_FULL_SCREEN_TPAS_IN_MOBILE,n.appDefinitionId)}(e,o)?n&&n():a?(e.enterFullScreenMode(),e.setSiteRootHiddenState(!0),r.enterFullScreen(n)):(e.setSiteRootHiddenState(!1),e.exitFullScreenMode(),r.exitFullScreen(n))}else n({error:{message:"show full screen is only available in Mobile view"}})},resizeWindow:function(e,i,n){var a=i.data.width,o=i.data.height;U(a)||(a=parseFloat(a)),U(o)||(o=parseFloat(o));var r=e.getComponentById(i.compId);(function(e){return e&&e.resizeWindow&&t.includes(["wysiwyg.viewer.components.tpapps.TPAGluedWidget","wysiwyg.viewer.components.tpapps.TPAPopup","wysiwyg.viewer.components.tpapps.TPAModal"],e.props.structure.componentType)})(r)&&r.resizeWindow(a,o,n)},appStateChanged:function(e,t){var i="string"==typeof t.data?t.data:t.data.state,n=e.getComponentById(t.compId),a=void 0,r=e.getRootOfComponentId(t.compId),s=e.getSiteData().getExistingRootNavigationInfo(r),p=s?s.pageId:r;try{switch((a=JSON.parse(i)).cmd){case"zoom":n.processImageZoom(a);break;case"itemClicked":n.processItemClicked(a);break;case"itemChanged":n.processItemChanged(a);break;case"componentReady":n.setComponentInIframeReady();break;case"navigateToDynamicPage":var c=a.args[0],u=o.wixUrlParser.getUrl(e.getSiteData(),c),g=o.wixUrlParser.parseUrl(e.getSiteData(),u);a.args[1]&&(g.anchorData=a.args[1]),e.handleNavigation(g,a.args[2]);break;case"navigateToAnchor":var d=a.args[0],l=a.args[1];e.getSiteData().getPrimaryPageId()===d?l&&e.scrollToAnchor(l):e.navigateToPage({pageId:d,pageAdditionalData:null,anchorData:l});break;default:G(e,n,p,i)}}catch(t){G(e,n,p,i)}},getSectionUrl:function(e,i,n){var a=e.getComponentById(i.compId);if(a){var o=p.services.pageService.mapPageToWidgets(e),r=e.getSiteData().getClientSpecMap()[a.props.compData.applicationId],s=r.applicationId;if(t.isEmpty(o)||t.isUndefined(o[s]))n({error:{message:'Page with app "'+r.appDefinitionName+'" was not found.'}});else{var c=o[s],u=i.data.sectionIdentifier,g=t.find(c,{tpaPageId:u})||c[0],d=void 0;if(g&&(d=g.pageId),t.isUndefined(d))n({error:{message:"Page was not found."}});else{var l=e.getPageUrlFor(d);t.isUndefined(l)?n({error:{message:"Page was not found."}}):n({url:l})}}}else n({error:{message:"Component was not found."}})},postCountersReport:function(e,i,n){i.data.messageId=Date.now();var a={ctToken:e.getSiteData().getCTToken()},r=t.omit(i.data,"version"),s="//player-counters.wix.com/collector/rest/collect-js?"+o.urlUtils.toQueryString(a);o.ajaxLibrary.ajax({type:"OPTIONS",url:s,data:JSON.stringify(r),dataType:"json",contentType:"application/json",success:function(e){n({status:"success",response:e})},error:function(e){var t=e&&e.responseText;n({status:"error",response:t})}})},getExternalId:function(e,t,i){var n=e.getComponentById(t.compId);n&&i(n.props.compData.referenceId)},getViewMode:function(e,t,i){i({editMode:e.getSiteData().isViewerMode()?"site":e.getRenderFlag("componentViewMode")})},getValue:J,getValues:Z,getPublicData:Y,getCurrentPageAnchors:function(e,t,i){var n=e.getSiteData().getCurrentUrlPageId(),a=p.common.utils.Constants.TOP_PAGE_ANCHOR_PREFIX+n,r=o.scrollAnchors.getPageAnchors(e.getSiteData(),n,a);u.getCurrentPageAnchors(e,t,n,r,i)},navigateToAnchor:function(e,i,n){var a=e.getSiteData().getCurrentUrlPageId(),r=p.common.utils.Constants.TOP_PAGE_ANCHOR_PREFIX+a,s=o.scrollAnchors.getPageAnchors(e.getSiteData(),a,r);u.navigateToAnchor(e,i,a,s,t.partial(te,e),n)},getStateUrl:function(e,i,n){var a=e.getComponentById(i.compId);if(!a)return n({error:{message:"Component was not found."}});var r=p.services.pageService.mapPageToWidgets(e),s=e.getSiteData().getClientSpecMap()[a.props.compData.applicationId],c=s.applicationId;if(t.isEmpty(r)||t.isUndefined(r[c]))return n({error:{message:'Page with app "'+s.appDefinitionName+'" was not found.'}});var u=r[c],g=t.find(u,{tpaPageId:i.data.sectionId}),d=void 0;return d=g?{pageId:g.pageId,tpaInnerRoute:i.data.state}:{pageId:u[0].pageId},e.getSiteData().isDynamicPage(d.pageId)?n({error:{message:"Can't retrieve url for a dynamic page. Please use the platform app API instead."}}):n({url:o.wixUrlParser.getUrl(e.getSiteData(),d,void 0,!0)})},getComponentInfo:function(e,i,n){var a=e.getComponentById(i.compId),o=a.props.compData,r=a.getAppData(),s=_(a),c=o.widgetId?r.widgets[o.widgetId]:p.services.clientSpecMapService.getMainSectionWidgetData(r);n({compId:i.compId,showOnAllPages:s,pageId:s?"":a.props.pageId,tpaWidgetId:t.get(c,"tpaWidgetId",""),appPageId:t.get(c,"appPage.id","")})},getStyleId:function(e,t,i){i(e.getComponentById(t.compId).props.structure.styleId)},getStyleParamsByStyleId:function(e,i,a){var r=e.getSiteData(),s=i.data.styleId,p=i.data.pageId,c=r.getAllStylesFromPossiblyRenderedRoots(),u=function(){if(t.isUndefined(c[s]))a({error:{message:'Style id "'+s+'" was not found.'}});else{var e=r.rendererModel.siteInfo.documentType,i=r.getDataByQuery("masterPage").characterSets,n=o.styleUtils.getStylesForSDK(c,s,!0,r.serviceTopology,e,i,!0);a(n)}},g=function(){var e;(e=r.getDataByQuery(s,p,"theme_data"))&&(c[s]=e),u()};if(t.isUndefined(c[s])&&p)if(r.pagesDataRaw.pagesData[p])g();else{var d=n.dataRequirementsChecker.getRequestsForPages(r,r.pagesDataRaw,{pageId:p});r.store.loadBatch(d,g)}else u()},replaceSectionState:function(e,i){var n=e.getComponentById(i.compId),a=i.data,o=a.state,r=a.queryParams,s=e.getRootOfComponentId(i.compId);if(p.common.utils.isTPASection(n)){n.setState({pushState:o});var u=n.getAppData(),g=e.getSiteData().getPrimaryPageId(),d=t.get(n,"props.compData.widgetId")||t.get(p.services.clientSpecMapService.getMainSectionWidgetData(u),"widgetId"),l=t.partial(ae,e,u,d,i.compId),f={pageId:s,tpaInnerRoute:o,transition:"none"};c.addAppSectionParamsToNavInfo(r,f),c.navigateWithoutClosingPopupIfPossible(e,f,g,!1,!0,void 0,l)}},logOutCurrentMember:function(e,i,n){var a=y(e);if(a.isLoggedIn()){var o=t.get(i,"data.language");a.logout(o)}else n({onError:"No member is logged in"})},getCtToken:function(e,i,n){t.isFunction(n)&&n(e.getSiteData().getCTToken())},setPageMetadata:function(e,i,n){var a=e.getComponentById(i.compId);if(a){var o=p.common.utils.isTPASection(a),r=t.get(a,"props.pageId")===e.getSiteData().getCurrentUrlPageId();if(!o)return void C(n,"Setting a page meta data is possible only to TPA Sections and MultiSections");if(!r)return void C(n,"Setting a page meta data is possible only to component that is located on the current page");var s=e.getPageData(),c=t.get(s,"title",""),u=t.get(i,"data.title"),g=t.get(i,"data.fullTitle"),d=t.get(i,"data.description")||t.get(s,"descriptionSEO",""),l=t.get(e.getSiteData(),"rendererModel.siteInfo.siteTitleSEO"),m=void 0;if(g){var v=a.getAppData();if(t.get(v,"isWixTPA"))return void e.setRunTimePageTitle(c,d,g)}u&&(m=f.isOpen("sv_tpaSetPageMetadata",e.getSiteData())?u+" | "+l:l+" | "+u),e.setRunTimePageTitle(c,d,m)}},setAppMetadata:function(e,i,n){var a=e.getComponentById(i.compId);if(a){var o=a.getAppData(),r=t.get(o,"isWixTPA"),c=p.common.utils.isTPASection(a),u=t.get(a,"props.pageId")===e.getSiteData().getCurrentUrlPageId();if(!r)return;if(!c)return void C(n,"Setting an app meta data is possible only for TPA Sections and MultiSections");if(!u)return void C(n,"Setting an app meta data is possible only for components that are located on the current page");var g=t.reduce(s.constants.TPA_LINK_TAGS.SUPPORTED_RELS,function(e,n){var a=t.get(i,"data."+n+".href");return a&&(e[n]=a),e},{});return e.setRunTimeLinkTags(g)}},removeAppMetadata:function(e,i,n){var a=e.getComponentById(i.compId);if(a){var o=a.getAppData(),r=t.get(o,"isWixTPA"),c=p.common.utils.isTPASection(a),u=t.get(a,"props.pageId")===e.getSiteData().getCurrentUrlPageId();if(!r)return;if(!c)return void C(n,"Removing an app meta data is possible only for TPA Sections and MultiSections");if(!u)return void C(n,"Removing an app meta data is possible only for components that are located on the current page");var g=t.reduce(t.get(i,"data"),function(e,i,n){return i&&t.includes(s.constants.TPA_LINK_TAGS.SUPPORTED_RELS,n)&&e.push(n),e},[]);return e.removePageSEORuntimeData(g)}},applicationLoaded:g.applicationLoaded,applicationLoadingStep:g.applicationLoadingStep,getAdsOnPage:function(e,t,i){var n=e.getSiteData();n.shouldShowWixAds()?f.isOpen("displayWixAdsNewVersion",n)?i({top:$(n,"top")}):n.isMobileView()?i({top:$(n,"top")}):i({top:$(n,"top"),bottom:$(n,"bottom")}):i({})},setMobileActionBarButton:function(e,i,n){var a=ee(e,(i=i||{}).compId).appDefinitionId;a||n({error:{message:"No matching app definition found for comp id "+i.compId}});var o=function(e){var i={};return t.isBoolean(e.visible)&&(i.enabled=e.visible),t.isBoolean(e.notifications)&&(i.notificationCount=e.notifications?1:0),t.isString(e.color)&&(i.color=e.color),i}(i.data||{});!t.isEmpty(o)&&(o.appId=a,function(e){return e.getSiteAspect("QuickActionBarAspect")}(e).updateDynamicActions(o)),n&&n()},isAppSectionInstalled:ie,getAppVendorProductId:ne,hasLoginOnPage:function(e,i,n){var a="wysiwyg.viewer.components.LoginSocialBar",o=e.getSiteData().getFocusedRootId(),r=e.getComponentsByPageId(o),s=t.some(r,["props.structure.componentType",a]);s||e.isPageLandingPage(o)||e.getSiteData().isPopupPage(o)||(r=e.getComponentsByPageId("masterPage"),s=t.some(r,["props.structure.componentType",a])),n(s)},registerApi:function(e,i){var n=e.getComponentById(i.compId),a=t.get(n.getIframe(),"id");e.getSiteAspect("TPARPCAspect").registerApi(a,i.compId)},requireSingletonAPI:function(e,i,n){var a=t.get(i.data,"appDefId"),o=t.get(i.data,"componentType");e.getSiteAspect("TPARPCAspect").requireSingletonAPI(a,o,n)},trackEvent:function(e,i){var n=t.get(i,"data.eventName"),a=t.get(i,"data.params"),r=t.get(i,"data.options");o.integrations.promoteAnalytics.trackEvent(e,n,a,r)},revalidateSession:function(e,i,n){var a=e.getComponentById(i.compId).getAppData(),o=t.get(a,"applicationId");e.getSiteAspect("dynamicClientSpecMap").getNewAppInstance(o,function(e){n(e?{instance:e}:{error:{message:"Error getting new instance from server"}})})},onReady:function(e,t,i){e.registerToOnFullyRendered(i)},echo:function(e,t,i){i()},getApplicationFields:function(e,i,n){var a=t.get(i.data,"appDefinitionId"),o=t(e.getSiteData().getClientSpecMap()).values().find({appDefinitionId:a});n(t.get(o,"appFields",{}))},tpaWorker:{siteInfo:T,getSitePages:D,getSiteMap:b,removeEventListener:W,registerEventListener:N,registerCampaignPixel:K,reportCampaignEvent:q,smCurrentMember:H,appIsAlive:Q,navigateToSectionPage:w,getValue:J,getValues:Z,getPublicData:Y,applicationLoaded:g.applicationLoaded,applicationLoadingStep:g.applicationLoadingStep,isAppSectionInstalled:ie,getAppVendorProductId:ne}},d)}.apply(t,n))||(e.exports=a)},543:function(e,t,i){var n,a;n=[i(0),i(1),i(42),i(544)],void 0===(a=function(e,t,i,n){"use strict";var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1];if(!e.isEmpty(t))try{i.queryParams={appSectionParams:JSON.stringify(t)},i.hasAppSectionParams=!0}catch(e){}},o=function(e,t,i,n,a){if(i){var o=e.getSiteAspect("tpaCompStateAspect");t?(o.updateSectionUrlState(i,n),o.updateSectionUrlParams(i,a)):(o.updatePushState(i,n),o.reportStateChanged(i,n))}},r=function(e,t,n){var a={appDefinitionName:t||"",sectionId:n||""};e.reportBI(i.bi.errors.SDK_NAVIGATION_TO_SECTION_ERROR,a)},s=function(t,i,n,a,o,r,s){i.pageId===n?(t.updatePageNavInfo(i,a,o),r&&t.scrollSiteTo(0,0)):t.navigateToPage(i,a,o),e.isFunction(s)&&s()};return{addAppSectionParamsToNavInfo:a,navigateToSection:function(t,n,p,c,u,g,d,l,f){if(n){var m=void 0,v=void 0,I=void 0,h=void 0,S=!1,P=p.data||"",A=!0,y={};if(e.isObject(p.data)&&(A=e.get(p,"data.sectionIdentifier.shouldRefreshIframe",!0),P=e.get(p,"data.sectionIdentifier.state")||p.data.state||"",y=e.get(p,"data.sectionIdentifier.queryParams"),v=e.get(p,"data.sectionIdentifier.sectionId"),S=e.get(p,"data.sectionIdentifier.noTransition"),h=e.get(p.data,["sectionIdentifier","customizeTarget","pageBackground"])),e.isUndefined(c)||e.isEmpty(c))r(t,n.appDefinitionName,v),l({error:{message:'Page with app "'+n.appDefinitionName+'" was not found.'}});else{if(e.isUndefined(v))m=c[0].pageId,I=i.services.clientSpecMapService.getMainSectionWidgetData(n);else{var T=e.find(c,{tpaPageId:v});if(e.isUndefined(T))return r(t,n.appDefinitionName,v),void l({error:{message:'App page with sectionId "'+v+'" was not found.'}});m=T.pageId,I=i.services.clientSpecMapService.getWidgetDataByTpaPageId(n,v)}if(d(m))return r(t,n.appDefinitionName,v),void l({error:{message:"Can't navigate to a dynamic page. Please use the platform app API instead."}});var C=g(m);o(t,A,C,P,y);var D={pageId:m,tpaInnerRoute:P};a(y,D),S&&(D.transition="none"),h&&(function(t){if(!e.startsWith(t,"rgba"))return!1;var i=(t=e(t).replace("rgba","").replace("(","").replace(")","")).split(",");if(4!==i.length)return!1;if(!e.every(i.slice(0,3),function(e){var t=e>=0&&e<=255,i=parseFloat(e),n=!isNaN(i)&&i>0&&i<=100;return t||n}))return!1;var n=e.last(i);return!n||n>=0&&n<=1}(h)?D.pageBackgroundColorOverride=h:l({error:{message:'Color should be rgba but "'+h+'" is not rgba format.'}}));var b=void 0;e.isFunction(f)&&(b=e.partial(f,e.get(I,"widgetId"),C)),s(t,D,u,void 0,void 0,!0,b)}}else{var w=e.get(p,"data.sectionIdentifier.appDefinitionId");w?(r(t),l({error:{message:'Application with appDefinitionId "'+w+'" was not found on the site.'}})):(r(t),l({error:{message:"Component was not found."}}))}},navigateWithoutClosingPopupIfPossible:s,navigateToPage:function(i,a,o,r,s,p,c){var u=e.get(a,"data.pageId"),g=e.get(a,"data.noTransition"),d=e.get(a,"data.anchorId"),l=s(u);o===u?d&&n.navigateToAnchor(i,a,u,l,p,c):t.linkUtils.navigateToPage(i,u,r,g,void 0,function(){d&&n.navigateToAnchor(i,a,u,l,p,c)},c)}}}.apply(t,n))||(e.exports=a)},544:function(e,t,i){var n,a;n=[i(0),i(1)],void 0===(a=function(e,t){"use strict";var i=function(e){return{id:e.compId,title:e.name}},n=function(t,n){return e.map(n,i)};function a(t,i,a){var o=n(t,i);return e.some(o,{id:a})}return{getCurrentPageAnchors:function(e,t,i,a,o){o(n(i,a))},navigateToAnchor:function(e,i,n,o,r,s){var p=i.data.anchorId;if(p===t.siteConstants.PAGE_ANCHORS.TOP_ANCHOR_COMP_ID)e.scrollToAnchor(t.siteConstants.PAGE_ANCHORS.TOP_ANCHOR_ID);else if(p===t.siteConstants.PAGE_ANCHORS.BOTTOM_ANCHOR_COMP_ID)e.scrollToAnchor(t.siteConstants.PAGE_ANCHORS.BOTTOM_ANCHOR_ID);else if(a(n,o,p)){var c=r(p);c&&e.scrollToAnchor(c)}else s&&s({error:{message:'anchor with id "'+p+'" was not found on the current page.'}})},isAnchorExistsOnPage:a}}.apply(t,n))||(e.exports=a)},545:function(e,t,i){var n,a;n=[i(11),i(0),i(9)],void 0===(a=function(e,t,i){"use strict";var n=function(e){if(t.isString(e)){var i=parseInt(e,10);return t.isNaN(i)?0:i}return t.isNumber(e)?e:0},a=function(e){return t.get(e,"props.compData.tpaData")},o=function(e,n,o,r,s,p,c){var u=e.getComponentById(n);return{origCompId:n,applicationId:t.get(u,"props.compData.applicationId"),externalId:t.get(u,"props.compData.referenceId"),tpaData:a(u),url:o,width:r,height:s,theme:p,title:c,windowSize:{width:i(window).width(),height:i(window).height()}}};return{openModal:function(e,i,n,a,r,s,p,c){var u=function(e){return e.getSiteAspect("tpaModalAspect")}(e),g=function(e,i,n,a,r,s,p){var c=o(e,i,n,a,r,s,p);return t.omitBy(c,t.isUndefined)}(e,i,n,a,r,s,c);u.showModal(g,p)},openPopup:function(a,r,s,p,c,u,g,d,l){if(!function(e){return!t.includes(["wysiwyg.viewer.components.tpapps.TPAModal"],t.get(e,"props.structure.componentType"))}(a.getComponentById(r))){var f=new Error;throw f.name="Operation not supported",f.message="An app can not open a popup from a modal.",f}(function(e){return e.getSiteAspect("tpaPopupAspect")})(a).showPopup(function(a,r,s,p,c,u,g,d){var l=a.getComponentById(r),f=o(a,r,s,p,c,u),m=e.findDOMNode(l);if(m){f.origCompStyle=i(m).offset();var v=m.getBoundingClientRect();f.origCompStyle.actualTop=v.top,f.origCompStyle.actualLeft=v.left}return f.position=t.defaults(g||{},{origin:"FIXED",placement:"CENTER",x:0,y:0}),f.position.x=n(f.position.x),f.position.y=n(f.position.y),f.persistent=d,t.omitBy(f,t.isUndefined)}(a,r,s,p,c,u,g,d),l)}}}.apply(t,n))||(e.exports=a)},546:function(e,t,i){var n,a;n=[i(0),i(42),i(10)],void 0===(a=function(e,t,i){"use strict";var n={};return{sendBIEvent:function(a,o,r,s,p){var c=function(t,i){return t.widgetId=e.get(i,"widgetId"),t.appId=e.get(i,"applicationId"),t}(a,r);if(function(e,t){return t&&e.version&&e.type&&e.namespace}(c,r)){var u=e.get(r,"applicationId"),g={count:1,target:1};if(e.has(n,[u,a.type])?++(g=e.get(n,[u,a.type])).count:(n[u]||(n[u]={}),n[u][a.type]=g),g.count===g.target){var d={visitorUuid:t.common.utils.getVisitorUuid(i),sdkVersion:c.version,origin:o,fnName:c.type,param:JSON.stringify(a.data),namespace:c.namespace,count:g.count};if(c.appId){var l=function(e,i){var n,a,o,r=t.common.utils.getInstanceFromClientSpecMap(i,e.appId);if(!i[e.appId])throw new Error("app definition could not be found by the given appId");return{appId:i[e.appId].appDefinitionId,instanceId:r.instanceId,isPublished:(n=i[e.appId],a=e.widgetId,o=n.widgets[a],(o?o.published||o.santaEditorPublished:n.sectionPublished)?1:0)}}(c,s);e.merge(d,l)}p(c.appId?t.bi.events.JS_SDK_FUNCTION_CALL:t.bi.events.GALLERY_FUNCTION_CALL,d),g.target*=10}}}}}.apply(t,n))||(e.exports=a)},6:function(e,t){e.exports=n},67:function(e,t){e.exports=g},9:function(e,t){e.exports=a}})});
//# sourceMappingURL=tpa.min.js.map